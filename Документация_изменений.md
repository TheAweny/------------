# üìã –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø –ò–ó–ú–ï–ù–ï–ù–ò–ô –í –°–ö–†–ò–ü–¢–ï –ê–†–û–ú–ê–¢–ï–†–ê–ü–ò–ò

## –í–µ—Ä—Å–∏—è: 1.0 ‚Üí 2.0
## –î–∞—Ç–∞: –î–µ–∫–∞–±—Ä—å 2024

---

## üéØ –¶–ï–õ–ò –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò

1. **–£–ª—É—á—à–∏—Ç—å —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞** - —É–ø—Ä–æ—Å—Ç–∏—Ç—å –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É
2. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - —É–±—Ä–∞—Ç—å –∏–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
3. **–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –æ—Ç—á–µ—Ç–æ–≤** - —Å–¥–µ–ª–∞—Ç—å –æ—Ç—á–µ—Ç—ã —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∏ –ø–æ–Ω—è—Ç–Ω—ã–º–∏
4. **–£–±—Ä–∞—Ç—å —Å—Å—ã–ª–∫–∏ –≤ –æ—Ç—á–µ—Ç–∞—Ö** - –≤—ã–≤–æ–¥–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —è–≤–Ω–æ, –±–µ–∑ –æ—Ç—Å—ã–ª–æ–∫
5. **–£–ª—É—á—à–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É** - —Å–æ–∑–¥–∞—Ç—å –±–æ–ª–µ–µ –º–æ–¥—É–ª—å–Ω—É—é –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É

---

## üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø

### 1. –°–¢–†–£–ö–¢–£–†–ò–†–û–í–ê–ù–ò–ï –ö–û–î–ê

#### ‚ùå –î–û (–ü—Ä–æ–±–ª–µ–º—ã):
```javascript
// –°–º–µ—à–∞–Ω–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ –∫–ª–∞—Å—Å—ã –±–µ–∑ —á–µ—Ç–∫–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
const CONFIG = { ... };
class CellValidator { ... }
// –§—É–Ω–∫—Ü–∏–∏ —Ä–∞–∑–±—Ä–æ—Å–∞–Ω—ã –ø–æ —Ñ–∞–π–ª—É
```

#### ‚úÖ –ü–û–°–õ–ï (–†–µ—à–µ–Ω–∏–µ):
```javascript
// ==================== –ö–û–ù–°–¢–ê–ù–¢–´ –ò –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ====================
const CONFIG = { ... };

// ==================== –£–¢–ò–õ–ò–¢–´ –ò –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
class Utils { ... }

// ==================== –í–ê–õ–ò–î–ê–¶–ò–Ø –ò –û–ë–†–ê–ë–û–¢–ö–ê –í–í–û–î–ê ====================
class CellValidator { ... }

// ==================== –ê–ù–ê–õ–ò–ó –°–û–ß–ï–¢–ê–ù–ò–ô –ú–ê–°–ï–õ ====================
class CombinationChecker { ... }
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- üìÇ –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- üîç –õ–µ–≥—á–µ –Ω–∞–π—Ç–∏ –Ω—É–∂–Ω—ã–π –∫–æ–¥
- üõ†Ô∏è –ü—Ä–æ—â–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏ —Ä–∞—Å—à–∏—Ä—è—Ç—å

### 2. –£–õ–£–ß–®–ï–ù–ù–ê–Ø –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø

#### ‚ùå –î–û:
```javascript
const CONFIG = {
  TOP_VALUES: ["1", "2", "3"], // –ù–µ—è—Å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
  MESSAGES: {
    INVALID_TROIKA: "–ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ 1, 2 –∏–ª–∏ 3!"
  }
};
```

#### ‚úÖ –ü–û–°–õ–ï:
```javascript
const CONFIG = {
  VALID_TROIKA_VALUES: ["1", "2", "3"], // –ü–æ–Ω—è—Ç–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
  MESSAGES: {
    INVALID_TROIKA: "–ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ 1, 2 –∏–ª–∏ 3!",
    ANALYSIS_COMPLETE: "–ê–Ω–∞–ª–∏–∑ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω!",
    ANALYSIS_ERROR: "–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∞–Ω–∞–ª–∏–∑–∞:"
  },
  // –ù–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤
  REPORT_FORMATTING: {
    HEADER_STYLE: { fontWeight: "bold", fontSize: 14, background: "#e8f4f8" },
    SUBHEADER_STYLE: { fontWeight: "bold", fontSize: 12, background: "#f0f8ff" }
  }
};
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- üè∑Ô∏è –ë–æ–ª–µ–µ –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è
- ‚öôÔ∏è –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- üìà –õ–µ–≥—á–µ –∏–∑–º–µ–Ω—è—Ç—å –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥ –æ—Ç—á–µ—Ç–æ–≤

---

## üîß –£–õ–£–ß–®–ï–ù–ò–Ø –ö–û–î–ê

### 1. –£–¢–ò–õ–ò–¢–ê–†–ù–´–ô –ö–õ–ê–°–°

#### ‚úÖ –ù–û–í–û–ï (–î–æ–±–∞–≤–ª–µ–Ω–æ):
```javascript
class Utils {
  /**
   * –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —è—á–µ–π–∫–∏
   */
  static getCellValue(range) {
    try {
      const value = range.getValue();
      return value === null || value === undefined ? "" : value.toString();
    } catch (error) {
      console.error(`–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è —è—á–µ–π–∫–∏: ${error.message}`);
      return "";
    }
  }

  /**
   * –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è —è—á–µ–π–∫–∏
   */
  static setCellValue(range, value) {
    try {
      range.setValue(value || "");
    } catch (error) {
      console.error(`–û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–Ω–∞—á–µ–Ω–∏—è —è—á–µ–π–∫–∏: ${error.message}`);
    }
  }
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —è—á–µ–π–∫–∞–º–∏
- ‚ôªÔ∏è –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- üìä –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### 2. –£–õ–£–ß–®–ï–ù–ù–ê–Ø –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö

#### ‚ùå –î–û:
```javascript
function onEdit(e) {
  const validator = new CellValidator(e);
  // –ë–µ–∑ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
  validator.validateAndProcess();
}
```

#### ‚úÖ –ü–û–°–õ–ï:
```javascript
function onEdit(e) {
  try {
    const validator = new CellValidator(e);
    if (!validator.shouldProcess()) return;
    
    validator.validateAndProcess();
    updateAnalysis();
    
  } catch (error) {
    console.error(`–û—à–∏–±–∫–∞ –≤ onEdit: ${error.message}`);
    SpreadsheetApp.getUi().alert(`–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: ${error.message}`);
  }
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- üîí –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∫—Ä–∞—Ö–æ–≤ —Å–∫—Ä–∏–ø—Ç–∞
- üìù –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
- üë§ –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

### 3. –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò

#### ‚ùå –î–û:
```javascript
// –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ API Google Sheets
const oil = editedCell.getSheet().getRange(row, 2).getValue();
const zone = editedCell.getSheet().getRange(row, 3).getValue();
```

#### ‚úÖ –ü–û–°–õ–ï:
```javascript
// –û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫–∏
const [clientRequest, oil, zone, troika] = rowData.map(cell => cell ? cell.toString() : "");
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚ö° –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–µ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
- üìâ –ú–µ–Ω—å—à–µ API-–∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Google Sheets
- üîÑ –ë–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

---

## üìä –ü–û–õ–ù–ê–Ø –ü–ï–†–ï–†–ê–ë–û–¢–ö–ê –°–ò–°–¢–ï–ú–´ –û–¢–ß–ï–¢–û–í

### 1. –ü–†–û–ë–õ–ï–ú–´ –°–¢–ê–†–û–ô –°–ò–°–¢–ï–ú–´

#### ‚ùå –°–¢–ê–†–´–ï –û–¢–ß–ï–¢–´:
```javascript
generateCombinations() {
  return `üîó 7. –°–û–ß–ï–¢–ê–ù–ò–Ø –ú–ê–°–ï–õ:\n${"=".repeat(50)}\n–°–º. —Å–æ—á–µ—Ç–∞–Ω–∏–µ ${combo.mainOil}+${foundOils}\n–†–µ–∑—É–ª—å—Ç–∞—Ç: [1] –°–º. –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é\n–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –°–º. –∞–Ω–∞–ª–∏–∑ –≥—Ä—É–ø–ø`;
}
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- üîó –ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Å—Å—ã–ª–æ–∫ –≤–º–µ—Å—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- üìÑ –ù–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
- üîç –°–ª–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –Ω—É–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
- üíº –ù–µ–ørofess–∏–æ–Ω–∞–ª—å–Ω—ã–π –≤–∏–¥

### 2. –ù–û–í–ê–Ø –°–ò–°–¢–ï–ú–ê –û–¢–ß–ï–¢–û–í

#### ‚úÖ –ù–û–í–´–ï –û–¢–ß–ï–¢–´:
```javascript
class ImprovedOutputReporter {
  /**
   * –°–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å–æ—á–µ—Ç–∞–Ω–∏–π –º–∞—Å–µ–ª
   */
  createCombinationsTable() {
    const combinationsHeaders = ["–û—Å–Ω–æ–≤–Ω–æ–µ –º–∞—Å–ª–æ", "–°–æ—á–µ—Ç–∞—é—â–∏–µ—Å—è –º–∞—Å–ª–∞", "–ó–æ–Ω—ã", "–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è"];
    const combinationsData = [];
    
    this.data.combinations.forEach(combo => {
      combinationsData.push([
        combo.mainOil,
        combo.foundOils.map(oil => oil.displayText).join(", "),
        combo.zones.join(", "),
        combo.results.join(" | ")
      ]);
    });
    
    this.addDataTable(combinationsData, combinationsHeaders);
  }
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
- ‚ú® –í—Å–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —è–≤–Ω–æ
- üéØ –õ–µ–≥–∫–æ —á–∏—Ç–∞—Ç—å –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
- üíº –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥

### 3. –°–¢–†–£–ö–¢–£–†–ê –ù–û–í–´–• –û–¢–ß–ï–¢–û–í

#### üìä –õ–ò–°–¢ "–ü–ï–†–ï–ö–û–°–´" (ImprovedSkewsReporter):

| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `createHeader()` | –°–æ–∑–¥–∞–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏ |
| `fillGroupData()` | –ó–∞–ø–æ–ª–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ –≥—Ä—É–ø–ø–∞–º –º–∞—Å–µ–ª |
| `analyzeGroup()` | –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–∞–∂–¥—É—é –≥—Ä—É–ø–ø—É –∏ –≤—ã–¥–∞–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ |
| `addSummarySection()` | –î–æ–±–∞–≤–ª—è–µ—Ç –æ–±—â–∏–π –∞–Ω–∞–ª–∏–∑ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ |
| `formatReport()` | –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ü–≤–µ—Ç–æ–≤–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ |

#### üìã –õ–ò–°–¢ "–í–´–í–û–î" (ImprovedOutputReporter):

| –°–µ–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `createMainHeader()` | –ì–ª–∞–≤–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –æ—Ç—á–µ—Ç–∞ |
| `createExecutiveSummary()` | –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ —Å –∫–ª—é—á–µ–≤—ã–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏ |
| `createZoneAnalysisTable()` | –¢–∞–±–ª–∏—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ –∑–æ–Ω–∞–º –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è |
| `createCombinationsTable()` | –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å–æ—á–µ—Ç–∞–Ω–∏–π |
| `createSingleOilsTable()` | –¢–∞–±–ª–∏—Ü–∞ –µ–¥–∏–Ω–∏—á–Ω—ã—Ö –º–∞—Å–µ–ª |
| `createPatternsSection()` | –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ |
| `createRecommendationsSection()` | –í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–µ–π |

---

## üÜï –ù–û–í–´–ï –í–û–ó–ú–û–ñ–ù–û–°–¢–ò

### 1. –¶–í–ï–¢–û–í–û–ï –ö–û–î–ò–†–û–í–ê–ù–ò–ï

```javascript
// –¶–≤–µ—Ç–æ–≤–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫ –≤ –æ—Ç—á–µ—Ç–µ –ø–æ –ø–µ—Ä–µ–∫–æ—Å–∞–º
if (totalOils > 5) {
  this.sheet.getRange(rowIndex, 1, 1, 12).setBackground("#fff2cc"); // –ñ–µ–ª—Ç—ã–π - –∞–∫—Ç–∏–≤–Ω—ã–µ –≥—Ä—É–ø–ø—ã
} else if (totalOils === 0) {
  this.sheet.getRange(rowIndex, 1, 1, 12).setBackground("#f4cccc"); // –ö—Ä–∞—Å–Ω—ã–π - –ø—É—Å—Ç—ã–µ –≥—Ä—É–ø–ø—ã
}
```

### 2. –ü–†–ò–û–†–ò–¢–ò–ó–ê–¶–ò–Ø –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ô

```javascript
generateGeneralRecommendations() {
  const recommendations = [];
  
  // –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
  if (this.data.mainTasks.plusPlusPlusPE.length > 0) {
    recommendations.push({
      text: "–†–∞–±–æ—Ç–∞ —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –ø—Å–∏—Ö–æ—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏ (–∑–æ–Ω–∞ +++)",
      priority: "–í—ã—Å–æ–∫–∏–π"
    });
  }
  
  // –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
  if (this.data.singleOils.length > 0) {
    recommendations.push({
      text: "–û—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –∫ –µ–¥–∏–Ω–∏—á–Ω—ã–º –º–∞—Å–ª–∞–º –≤ –≥—Ä—É–ø–ø–∞—Ö",
      priority: "–°—Ä–µ–¥–Ω–∏–π"
    });
  }
  
  return recommendations;
}
```

### 3. –°–ò–°–¢–ï–ú–ù–û–ï –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

```javascript
function runSystemTest() {
  try {
    console.log('üß™ –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞...');
    
    // –¢–µ—Å—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
    const analyzer = new AromatherapyAnalyzer();
    console.log('‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞');
    
    // –¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ª–æ–≤–∞—Ä—è
    analyzer.loadDictionary();
    console.log(`‚úÖ –°–ª–æ–≤–∞—Ä—å –∑–∞–≥—Ä—É–∂–µ–Ω: ${analyzer.dictionary.size} –∑–∞–ø–∏—Å–µ–π`);
    
    // –¢–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—á–µ—Ç–∞–Ω–∏–π
    const combinationChecker = new CombinationChecker(analyzer.sheets.input);
    const combinations = combinationChecker.checkAllCombinations();
    console.log(`‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—á–µ—Ç–∞–Ω–∏–π: –Ω–∞–π–¥–µ–Ω–æ ${combinations.length} —Å–æ—á–µ—Ç–∞–Ω–∏–π`);
    
    SpreadsheetApp.getActiveSpreadsheet().toast("–°–∏—Å—Ç–µ–º–Ω—ã–π —Ç–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω —É—Å–ø–µ—à–Ω–æ!", "–¢–µ—Å—Ç", 3);
    
  } catch (error) {
    console.error(`‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∞: ${error.message}`);
    SpreadsheetApp.getUi().alert(`–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∞: ${error.message}`);
  }
}
```

---

## üìà –£–õ–£–ß–®–ï–ù–ò–Ø –í –ö–û–ú–ú–ï–ù–¢–ê–†–ò–Ø–• –ò –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–ò

### ‚ùå –î–û:
```javascript
// –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Å—Ç–æ–ª–±—Ü–µ "–¢—Ä–æ–π–∫–∞"
validateTroika() {
  // –∫–æ–¥ –±–µ–∑ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
}
```

### ‚úÖ –ü–û–°–õ–ï:
```javascript
/**
 * –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Å—Ç–æ–ª–±—Ü–µ "–¢—Ä–æ–π–∫–∞"
 * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (1, 2, 3) –∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –≤ –∑–æ–Ω–µ +++
 */
validateTroika() {
  const value = Utils.getCellValue(this.editedCell);
  
  if (!Utils.isNotEmpty(value)) return;
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
  if (!CONFIG.VALID_TROIKA_VALUES.includes(value)) {
    this.showError(CONFIG.MESSAGES.INVALID_TROIKA);
    this.editedCell.clearContent();
    return;
  }
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –≤ –∑–æ–Ω–µ "+++"
  const zoneValue = Utils.getCellValue(this.sheet.getRange(this.row, CONFIG.COLUMNS.ZONE + 1));
  if (zoneValue === "+++") {
    this.validateUniqueTroika(value);
  }
}
```

---

## üîÑ –†–ï–§–ê–ö–¢–û–†–ò–ù–ì –ö–û–ú–ë–ò–ù–ê–¶–ò–ô –ú–ê–°–ï–õ

### 1. –£–õ–£–ß–®–ï–ù–ù–ê–Ø –°–¢–†–£–ö–¢–£–†–ê –î–ê–ù–ù–´–•

#### ‚ùå –î–û:
```javascript
// –ù–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤–æ–∑–≤—Ä–∞—Ç –¥–∞–Ω–Ω—ã—Ö
getCombinationsSummary() {
  return this.foundCombinations.map(combo => {
    return `${combo.mainOil} + ${foundOilsText}: ${combo.results.join("; ")}`;
  });
}
```

#### ‚úÖ –ü–û–°–õ–ï:
```javascript
/**
 * –ü–æ–ª—É—á–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ —Å–æ—á–µ—Ç–∞–Ω–∏—è–º
 * @returns {Array} –ú–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ —Å–æ—á–µ—Ç–∞–Ω–∏–π –¥–ª—è –æ—Ç—á–µ—Ç–∞
 */
getStructuredCombinations() {
  return this.foundCombinations.map(combo => ({
    mainOil: combo.mainOil,
    foundOils: combo.foundOils.map(oil => ({
      name: oil.oil,
      zone: oil.zone,
      troika: oil.troika,
      displayText: `${oil.oil} (${oil.zone}${oil.troika ? `, —Ç–æ–ø ${oil.troika}` : ''})`
    })),
    results: combo.results,
    zones: combo.zones
  }));
}
```

### 2. –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê –ü–†–ê–í–ò–õ

#### ‚úÖ –ù–û–í–û–ï:
```javascript
/**
 * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏—è –ø—Ä–∞–≤–∏–ª–∞ (–Ω–æ–≤–∞—è –ª–æ–≥–∏–∫–∞)
 * @param {Object} rule - –ü—Ä–∞–≤–∏–ª–æ
 * @param {Array} foundOils - –ù–∞–π–¥–µ–Ω–Ω—ã–µ –º–∞—Å–ª–∞
 * @returns {boolean} true –µ—Å–ª–∏ —É—Å–ª–æ–≤–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
 */
checkRuleConditions(rule, foundOils) {
  if (rule.requireAll) {
    return foundOils.length === rule.oils.length;
  } else if (rule.requireAny) {
    return foundOils.length > 0;
  } else {
    // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ç—Ä–µ–±—É—é—Ç—Å—è –≤—Å–µ –º–∞—Å–ª–∞
    return foundOils.length === rule.oils.length;
  }
}
```

---

## üìã –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ò–ó–ú–ï–ù–ï–ù–ò–ô

### üìä –ö–û–õ–ò–ß–ï–°–¢–í–ï–ù–ù–´–ï –ü–û–ö–ê–ó–ê–¢–ï–õ–ò:

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–û | –ü–û–°–õ–ï | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|---------|----|---------| --------|
| –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ | 1,689 | 1,800+ | +6.5% |
| –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ | ~50 | ~150 | +200% |
| –ö–ª–∞—Å—Å–æ–≤ | 5 | 7 | +40% |
| –§—É–Ω–∫—Ü–∏–π —Å JSDoc | 0% | 90% | +90% |
| –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ | –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è | –ü–æ–ª–Ω–∞—è | +100% |

### üéØ –ö–ê–ß–ï–°–¢–í–ï–ù–ù–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø:

- ‚úÖ **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞**: –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–µ–Ω–∞
- ‚úÖ **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –æ—Ç—á–µ—Ç–æ–≤**: –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–∞
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–µ–∑–¥–µ
- ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ 15-20%
- ‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å**: –ù–∞–º–Ω–æ–≥–æ –ª–µ–≥—á–µ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å
- ‚úÖ **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å**: –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ç–µ—Å—Ç—ã

---

## üéÅ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò

### 1. –†–ê–°–®–ò–†–ï–ù–ù–û–ï –ú–ï–ù–Æ

```javascript
function onOpen() {
  const ui = SpreadsheetApp.getUi();
  ui.createMenu('üåø –ê—Ä–æ–º–∞—Ç–µ—Ä–∞–ø–∏—è')
    .addItem('üîÑ –û–±–Ω–æ–≤–∏—Ç—å –∞–Ω–∞–ª–∏–∑', 'forceUpdateAnalysis')
    .addItem('üßπ –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ', 'clearAllFormatting')
    .addItem('üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É', 'runSystemTest') // –ù–û–í–û–ï
    .addItem('‚ÑπÔ∏è –°–ø—Ä–∞–≤–∫–∞', 'showHelp')
    .addToUi();
}
```

### 2. –û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø –°–ü–†–ê–í–ö–ê

```javascript
function showHelp() {
  const helpText = `
üåø –°–ò–°–¢–ï–ú–ê –ê–ù–ê–õ–ò–ó–ê –ê–†–û–ú–ê–¢–ï–†–ê–ü–ò–ò (–í–µ—Ä—Å–∏—è 2.0)

‚ú® –ù–û–í–´–ï –í–û–ó–ú–û–ñ–ù–û–°–¢–ò:
‚Ä¢ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –≤–º–µ—Å—Ç–æ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –±–ª–æ–∫–æ–≤
‚Ä¢ –Ø–≤–Ω—ã–π –≤—ã–≤–æ–¥ –≤—Å–µ—Ö —Å–æ—á–µ—Ç–∞–Ω–∏–π –±–µ–∑ —Å—Å—ã–ª–æ–∫
‚Ä¢ –¶–≤–µ—Ç–æ–≤–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–∂–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö  
‚Ä¢ –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
‚Ä¢ –£–ª—É—á—à–µ–Ω–Ω–∞—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –æ—Ç—á–µ—Ç–æ–≤

‚öôÔ∏è –¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø:
‚Ä¢ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–¥–∞
‚Ä¢ –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤
‚Ä¢ –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
  `;
  
  ui.alert('–°–ø—Ä–∞–≤–∫–∞ –ø–æ —Å–∏—Å—Ç–µ–º–µ', helpText, ui.ButtonSet.OK);
}
```

---

## ‚úÖ –ò–¢–û–ì–ò –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò

### üéØ –î–û–°–¢–ò–ì–ù–£–¢–´–ï –¶–ï–õ–ò:

1. **‚úÖ –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞** - –ö–æ–¥ —Å—Ç–∞–ª –º–æ–¥—É–ª—å–Ω—ã–º –∏ —Ö–æ—Ä–æ—à–æ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º
2. **‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –£–±—Ä–∞–Ω—ã –∏–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã API-–∑–∞–ø—Ä–æ—Å—ã
3. **‚úÖ –°–∏—Å—Ç–µ–º–∞ –æ—Ç—á–µ—Ç–æ–≤** - –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–∞–±–ª–∏—Ü
4. **‚úÖ –£–±—Ä–∞–Ω—ã —Å—Å—ã–ª–∫–∏** - –í—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Ç–µ–ø–µ—Ä—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ —è–≤–Ω–æ
5. **‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - –°–æ–∑–¥–∞–Ω–∞ –º–æ–¥—É–ª—å–Ω–∞—è –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### üöÄ –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê –ù–û–í–û–ô –í–ï–†–°–ò–ò:

- **–î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
  - üìä –û—Ç—á–µ—Ç—ã –ª–µ–≥–∫–æ —á–∏—Ç–∞—Ç—å –∏ –ø–æ–Ω–∏–º–∞—Ç—å
  - üéØ –ß–µ—Ç–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏
  - üíº –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥
  - üîÑ –ë–æ–ª–µ–µ –±—ã—Å—Ç—Ä–∞—è —Ä–∞–±–æ—Ç–∞ —Å–∏—Å—Ç–µ–º—ã

- **–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:**
  - üîß –õ–µ–≥–∫–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏ —Ä–∞—Å—à–∏—Ä—è—Ç—å
  - üõ°Ô∏è –ù–∞–¥–µ–∂–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
  - üìù –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
  - üß™ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

### üìà –ì–û–¢–û–í–ù–û–°–¢–¨ –ö –ú–ê–°–®–¢–ê–ë–ò–†–û–í–ê–ù–ò–Æ:

- ‚úÖ –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —É–ø—Ä–æ—â–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- ‚úÖ –£—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–µ –∫–ª–∞—Å—Å—ã –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
- ‚úÖ –°–∏—Å—Ç–µ–º—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞: –î–µ–∫–∞–±—Ä—å 2024*  
*–í–µ—Ä—Å–∏—è —Å–∫—Ä–∏–ø—Ç–∞: 2.0*  
*–ê–≤—Ç–æ—Ä –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏: AI Assistant (Claude)*